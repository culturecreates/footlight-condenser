

<h1>Statements</h1>
<% if params[:rdf_uri] %>
  <p> Showing <%= @statements.count %> statements for resource <%= params[:rdf_uri] %> <%=  link_to "Refresh", refresh_rdf_uri_statements_path(rdf_uri: params[:rdf_uri]), method: :patch %> | <%=  link_to "Crawl (1 hr cache)", refresh_rdf_uri_statements_path(rdf_uri: params[:rdf_uri], force_scrape_every_hrs: 1), method: :patch %> | <%= link_to "Console", "#{get_console_url_per_environment}/events/#{params[:rdf_uri]}" %>
      </p>
<% elsif params[:seedurl] %>
 <p> Showing <%= @statements.count %> statements for website <%= params[:seedurl] %> | <%= link_to "Console", "#{get_console_url_per_environment}/events?seedurl=#{params[:seedurl]}" %>
      </p>
<% end %>

<%= form_tag(batch_update_statements_path) do -%>
<h3>Filtered by:</h3>
seedurl(all): <%= text_field_tag 'seedurl',  params[:seedurl] %> 

rdf_uri:  <%=text_field_tag 'rdf_uri',   params[:rdf_uri] %>

prop:  <%=text_field_tag 'prop',  params[:prop], size: 6 %>

status: <%=text_field_tag 'status', params[:status] %>

selected:  <%=text_field_tag 'selected', params[:selected] ,size:  6%> 

selected_individual:  <%=text_field_tag 'selected_individual', params[:selected_individual], size: 6 %>

source:  <%=text_field_tag 'source', params[:source] %>

<%= submit_tag 'View' %>


 <div><%= text_area_tag 'update_data','', placeholder: 'selected: true, cache: ["one"]' %><%= submit_tag 'Update' %></div>
<% end -%>

<%= link_to "Review all", review_all_statements_path(rdf_uri: params[:rdf_uri], seedurl: params[:seedurl], prop: params[:prop], status: params[:status]), method: :patch %>
<%= link_to "Refresh all", refresh_all_statements_path(rdf_uri: params[:rdf_uri], seedurl: params[:seedurl], prop: params[:prop], status: params[:status]), method: :patch %>
<br>
<br>
<%= will_paginate @statements %>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Property</th>
      <th>Cache</th>
      <th>Status</th>
       <th>Manual</th>
      <th>Selected Source</th>
      <th>Selected Individual</th>
      <th>Status origin</th>
      <th>Cache refreshed</th>
      <th>Cache changed</th>
  
     
      <th colspan="4"></th>
    </tr>
  </thead>

  <tbody>
    <% @statements.each do |statement| %>
      <tr  <%= "style=color:red;" if !statement.source.selected %> >
        <td><%= statement.id %></td>
        <td><%= statement.source.property.label %> <%= format_language statement.source.language%></td>
        <td><%= statement.cache %></td>
        <td><%= statement.status %></td>
         <td><%= statement.manual %></td>
        <td <%= "style=background-color:pink;" if !statement.source.selected %>><%= statement.source.selected %></td>
        <td <%= "style=background-color:green;" if statement.selected_individual %>><%= statement.selected_individual %></td>
        <td><%= statement.status_origin %></td>
        <td><%= statement.cache_refreshed %></td>
        <td><%= statement.cache_changed %></td>

        <td><%= link_to 'Show', statement %></td>
        <td><%= link_to 'Edit', edit_statement_path(statement) %></td>
        <td><%= link_to 'Destroy', statement, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <td><%= link_to 'Report', source_reports_path(source_id: statement.source) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Statement', new_statement_path %>
